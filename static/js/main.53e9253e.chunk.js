(this["webpackJsonpdice-town"]=this["webpackJsonpdice-town"]||[]).push([[0],{56:function(e,t,n){e.exports=n(75)},66:function(e,t,n){},67:function(e,t,n){},68:function(e,t,n){},70:function(e,t,n){},71:function(e,t,n){},72:function(e,t,n){},75:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),o=n(28),c=n.n(o);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var i=n(13),u=n(88),l=n(51),s=(n(66),n(67),n(19)),d=n(54),p=n(93),f=(n(68),n(43)),m=n.n(f),v=n(47),b=n(48),O=Object.freeze({roll:"ROLL",moveRollToSlot:"MOVE_ROLL_TO_SLOT",returnRoll:"RETURN_ROLL",removeRollFromFailedCards:"REMOVE_ROLL_FROM_FAILED_CARDS",collectAllDiceToRoll:"COLLECT_ALL_DICE_TO_ROLL",removeCard:"REMOVE_CARD",addCard:"ADD_CARD"}),R=function(e){return new Promise((function(t){return setTimeout(t,e)}))},E=function(e){return{type:O.removeCard,cardId:e}},h=Object.freeze({roll:"ROLL",done:"DONE",resolving:"resolving"}),y=Object.freeze({dice:"DICE"}),j=n(90),k=n(78),w=n(94),C=n(36),g=n(79),D=n(53),A=n(80),T=n(92),I=(n(70),function(e){var t=e.pos,n=e.of,r=e.type,o=["pip","pip".concat(t,"of").concat(n),"pip-".concat(r)].join(" ");return a.a.createElement("div",{className:o})}),L=function(e){var t=e.faces,n=e.up,o=e.id,c=t[n],i=c.pips,u=c.type,l=Object(r.useState)(!1),d=Object(s.a)(l,2),p=d[0],f=d[1],m=Object(T.a)({item:{type:y.dice,id:o,up:n,pips:i,pipsType:u},begin:function(){f(!1)}}),v=Object(s.a)(m,2)[1],b=function(e,t){return j.a(k.a(w.a(1,e+1)),C.a((function(n){return a.a.createElement(I,{type:t,pos:n,of:e,key:n})})))()},O=g.a(C.a);return a.a.createElement("div",{className:"dice ".concat(p?"dice-open":""),onClick:function(){return f(!p)},ref:v},b(i,u),p&&j.a(k.a(w.a(0,6)),D.a((function(e){return e!==n})),A.a(2,n),C.a((function(e){return t[e]})),O((function(e,t){return a.a.createElement("div",{className:"dice dice-ghost dice-ghost".concat(t),key:t},e&&b(e.pips,e.type))})))())},x=(n(71),function(e){var t=e.onDrop,n=e.selectedRoll,r=Object(p.a)({accept:y.dice,drop:t,canDrop:function(e){return!0}}),o=Object(s.a)(r,2)[1];return a.a.createElement("div",{className:"slot",ref:o},n&&a.a.createElement(L,{up:n.up,faces:n.pop.faces,id:n.pop.id}))}),N=(n(72),function(e){var t=e.description,n=e.card,r=["requirement",(0,e.testCard)(n)?"requirement-fullfilled":"requirement-failed"].join(" ");return a.a.createElement("p",{className:r},t)}),_=function(e){var t=e.title,n=e.description,r=e.slots,o=e.id,c=e.requirements,u=Object(i.b)(),l=function(e){return function(t){return u(function(e){var t=e.diceId,n=e.cardId,r=e.slot;return{type:O.moveRollToSlot,diceId:t,cardId:n,slot:r}}({diceId:t.id,cardId:o,slot:e}))}};return a.a.createElement("div",{className:"card"},a.a.createElement("h2",null,t),a.a.createElement("p",null,n),a.a.createElement("div",{className:"requirements"},c.map((function(t,n){return a.a.createElement(N,Object.assign({},t,{card:e,key:n}))}))),a.a.createElement("div",{className:"slots"},r.map((function(e,t){return a.a.createElement(x,Object.assign({},e,{onDrop:l(t),key:t}))}))))},S=function(){var e=Object(i.c)(d.a(["board","freePops"])),t=Object(i.c)(d.a(["board","cards"])),n=Object(i.c)(d.a(["board","nextAction"])),r=Object(i.b)(),o=Object(p.a)({accept:y.dice,drop:function(e){return r((t=e.id,{type:O.returnRoll,diceId:t}));var t}}),c=Object(s.a)(o,2)[1];return a.a.createElement("main",{className:"board"},a.a.createElement("div",{className:"cards"},t&&t.map((function(e){return a.a.createElement(_,Object.assign({},e,{key:e.id}))}))),n===h.roll&&a.a.createElement("button",{onClick:function(){return r({type:O.roll})}},"Roll"),n===h.done&&a.a.createElement("button",{onClick:function(){return r(function(){var e=Object(b.a)(m.a.mark((function e(t,n){var r,a,o,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=1e3,t({type:O.removeRollFromFailedCards}),e.next=4,R(r);case 4:a=n().board.cards,o=Object(v.a)(a),e.prev=6,o.s();case 8:if((c=o.n()).done){e.next=15;break}return c.value.resolve(t),e.next=13,R(r);case 13:e.next=8;break;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e.catch(6),o.e(e.t0);case 20:return e.prev=20,o.f(),e.finish(20);case 23:t({type:O.collectAllDiceToRoll});case 24:case"end":return e.stop()}}),e,null,[[6,17,20,23]])})));return function(t,n){return e.apply(this,arguments)}}())}},"Done"),n===h.resolving&&a.a.createElement("button",{disabled:!0},"resolving"),a.a.createElement("div",{className:"free-pops",ref:c},e&&e.map((function(e){var t=e.up,n=e.pop,r=n.faces,o=n.id;return a.a.createElement(L,{up:t,faces:r,id:o,key:o})}))))};var q,M=function(){return a.a.createElement("div",{className:"App"},a.a.createElement("header",{className:"App-header"},a.a.createElement("h1",null,"Dice Town")),a.a.createElement(S,null))},P=n(11),F=n(49),z=n(50),W=function(e){var t=e.createStore,n=e.applyMiddleware,r=e.thunk,a=e.composeWithDevTools;return function(e){var o=e.rootReducer,c=e.preloadedState;return t(o,c,a({})(n(r)))}}({createStore:P.createStore,applyMiddleware:P.applyMiddleware,thunk:F.a,composeWithDevTools:z.composeWithDevTools}),V=n(32),B=n(21),J=n(52),U=function(e){return function(t){return J.a(t,e)?e:t}},$=function(e){return function(t){return j.a(e,U(t))(t)}},G=function(e,t){return $(C.a((function(n){return e(n)?t(n):n})))},H=function(e,t){return $((function(n){return Object(B.a)({},n,Object(V.a)({},e,t(n[e])))}))},K=n(33),Q=Object.freeze({work:"work",live:"live"}),X=function(){return{id:Object(K.uuid)(),faces:[{pips:0,type:Q.work},{pips:0,type:Q.work},{pips:1,type:Q.work},{pips:1,type:Q.work},{pips:1,type:Q.work},{pips:6,type:Q.live}]}},Y=[X(),X()],Z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(arguments.length>1&&void 0!==arguments[1]&&arguments[1],e.pops),n=void 0===t?Y:t;return n},ee=n(97),te=n(81),ne=n(30),re=n(98),ae=n(84),oe=n(85),ce=n(86),ie=n(87),ue=n(96),le=n(91),se=n(82),de=n(89),pe=n(99),fe=n(83),me=n(95),ve=le.a(se.a),be=function(e){return e.pop.faces[e.up]},Oe=function(e){return ue.a((function(t){return(0,t.testCard)(e)}),e.requirements)},Re=Object.freeze({"intro 1":function(){return{title:"Place a citizen",description:"The dice are your citizens and you can place them after rolling",slots:[{},{}],requirements:[(e=2,{description:"min ".concat(e," dice"),testCard:j.a(te.a("slots"),C.a((function(e){return e.selectedRoll?1:0})),me.a,(function(t){return t>=e}))})],resolve:function(e){var t;Oe(this)&&(e(E(this.id)),e((t="intro 2",{type:O.addCard,name:t})))}};var e},"intro 2":function(){return{title:"To many needed",description:"Sometimes you can not meet the cards requirement",slots:[{},{}],requirements:[(e=3,{description:"min ".concat(e," work"),testCard:j.a(te.a("slots"),D.a(fe.a(ve,"selectedRoll")),C.a((function(e){return e.selectedRoll})),C.a(be),D.a((function(e){return e.type===Q.work})),C.a((function(e){return e.pips})),me.a,(function(t){return t>=e}))})],resolve:function(e){Oe(this)&&e(E(this.id))}};var e}}),Ee=function(e){return Object(B.a)({id:Object(K.uuid)(),name:e},Re[e]())},he={nextAction:h.roll,freePops:[],cards:[Ee("intro 2")]},ye=function(e,t){return e.nextAction!==h.roll?e:Object(B.a)({},e,{nextAction:h.done,freePops:t.map((function(e){return{pop:e,up:Math.floor(6*Math.random())}}))})},je=function(e){return ne.a((function(t,n){var r=n.slots;return t||function(e){return j.a(C.a(te.a("selectedRoll")),ee.a((function(t){return t&&t.pop.id===e})))}(e)(r)}),void 0)},ke=function(e){return D.a((function(t){return t.pop.id!==e}))},we=function(e,t){return G((function(t){return t.id===e}),t)},Ce=function(e){return G((function(t){return re.a((function(t){return t.selectedRoll&&t.selectedRoll.pop.id===e}))(t.slots)}),H("slots",G((function(t){var n=t.selectedRoll;return n&&n.pop.id===e}),H("selectedRoll",(function(){})))))},ge=function(e){var t=e.diceId,n=e.cardId,r=e.slot;return function(e){var a=function(e){return ee.a((function(t){return t.pop.id===e}))}(t)(e.freePops)||je(t)(e.cards),o=function(e){return ee.a((function(t){return t.id===e}))}(n)(e.cards).slots[r].selectedRoll;return o===a||e.nextAction!==h.done?e:ae.a({freePops:j.a(ke(t),oe.a((function(){return o}),ce.a(o))),cards:j.a(Ce(t),we(n,H("slots",ie.a(r,H("selectedRoll",(function(){return a}))))))})(e)}},De=function(e){return function(t){var n=je(e)(t.cards);return n&&t.nextAction===h.done?ae.a({freePops:ce.a(n),cards:Ce(e)})(t):t}},Ae=le.a((function(e){return ue.a((function(t){return(0,t.testCard)(e)}),e.requirements)})),Te=le.a(se.a),Ie=C.a(oe.a(Ae,H("slots",C.a(H("selectedRoll",(function(){})))))),Le=function(e){return ae.a({nextAction:function(){return h.resolving},freePops:(t=e.cards,de.a(j.a(k.a(t),D.a(Ae),C.a(te.a("slots")),pe.a,D.a(fe.a(Te,"selectedRoll")),C.a(te.a("selectedRoll")))())),cards:Ie})(e);var t},xe=ae.a({nextAction:function(){return h.roll},freePops:function(){return[]},cards:C.a(H("slots",C.a(H("selectedRoll",(function(){})))))}),Ne=function(e){return ae.a({cards:D.a((function(t){return t.id!==e}))})},_e=function(e){return ae.a({cards:ce.a(Ee(e))})},Se=W({rootReducer:(q={pops:Z,board:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.board,r=void 0===n?he:n,a=e.pops,o=t.type,c=t.diceId,i=t.cardId,u=t.slot,l=t.name;switch(o){case O.roll:return ye(r,a);case O.moveRollToSlot:return ge({diceId:c,cardId:i,slot:u})(r);case O.returnRoll:return De(c)(r);case O.removeRollFromFailedCards:return Le(r);case O.collectAllDiceToRoll:return xe(r);case O.removeCard:return Ne(i)(r);case O.addCard:return _e(l)(r);default:return r}}},function(e,t){return j.a(C.a((function(n){return n(e,t)})),U(e))(q)}),preloadedState:void 0});c.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(u.a,{backend:l.a},a.a.createElement(i.a,{store:Se},a.a.createElement(M,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[56,1,2]]]);
//# sourceMappingURL=main.53e9253e.chunk.js.map